(function(n,t){if(n.config.devtools=!0,document.querySelector("#requests")){n.use(t);var i=new n({el:"#requests",data:{textariaClass:"materialize-textarea",datepickerClass:"datepicker",autocompleteClass:"autocomplete",colClass:"col",pagingInfo:{contentUrl:"",currentPage:0,endIndex:0,endPage:0,itemsPerPage:0,pages:[],startIndex:0,startPage:0,totalItems:0,totalPages:0},requests:[],statuses:[],isManager:!1,isNew:!1,requestModel:{},requestDetails:[],scope:"Add new",emptyDetail:{manufacturer:"",model:""},currentRequestStatus:0,searchRequest:""},created:function(){this.loadRequests()},methods:{loadRequests:function(n,t){var i=this,r=window.location.search,u="/Request/List"+r;t&&showLoader();$.ajax({url:u,method:"GET",data:n,success:function(n){i.requests=n.requests;i.isManager=n.isManager;i.pagingInfo=n.pagingInfo;t&&hideLoader()},error:function(n){console.log(n);t&&hideLoader()}})},edit:function(n){if(this.$validator.reset(),this.isNew=!1,this.scope="Edit",n){var t=this;$.ajax({url:"/Request/Get",data:{id:n},method:"GET",success:function(i){if(t.requestModel=i.request,t.statuses=i.statuses,t.currentRequestStatus=i.currentRequestStatus,t.requestModel.dateStudy=dateCorrectStr(i.request.dateStudy),i.details&&i.details.length>0){for(var u=0;u<i.details.length;u++)i.details[u].shippingDate=dateCorrectStr(i.details[u].shippingDate),i.details[u].trainingDate=dateCorrectStr(i.details[u].trainingDate),i.details[u].installationDate=dateCorrectStr(i.details[u].installationDate),i.details[u].estimatedLeadTime=dateCorrectStr(i.details[u].estimatedLeadTime),i.details[u].sivRequiredDate=dateCorrectStr(i.details[u].sivRequiredDate),i.details[u].confirmedDeliveryDate=dateCorrectStr(i.details[u].confirmedDeliveryDate),i.details[u].actualDespatchDate=dateCorrectStr(i.details[u].actualDespatchDate),i.details[u].actualInstallationDate=dateCorrectStr(i.details[u].actualInstallationDate),i.details[u].issuedDate=dateCorrectStr(i.details[u].issuedDate),i.details[u].paymentDueDate=dateCorrectStr(i.details[u].paymentDueDate),i.details[u].paymentRunDate=dateCorrectStr(i.details[u].paymentRunDate),i.details[u].paymentReceivedDate=dateCorrectStr(i.details[u].paymentReceivedDate),i.details[u].serviceDueDate=dateCorrectStr(i.details[u].serviceDueDate),i.details[u].deInstallDueDate=dateCorrectStr(i.details[u].deInstallDueDate),i.details[u].estimateDeliveryDate=dateCorrectStr(i.details[u].estimateDeliveryDate);t.requestDetails=i.details}else t.requestDetails=[t.getEmptyDetail()];setTimeout(function(){r();initEventsByClosePopup()},300);t.resetInvoiceFiles();updateWindowHref(n)},error:function(n){console.log(n)}})}},dateCorrectStr:function(n){return dateCorrectStr(n)},update:function(){if(this.isNew){this.updateRequest("/Request/New");return}var n=this,t=function(){for(var i=!0,t=0;t<n.requestDetails.length;t++)n.requestDetails[t].invoiceFile||($("#InvoiceFile-text"+t).addClass("input-validation-error"),$("#InvoiceFile-text-error"+t).removeClass("hide"),i=!1);return i};this.requestModel.status>30&&!t()||this.updateRequest("/Request/Set")},updateRequest:function(n){var t=this;this.requestModel.details=this.requestDetails;this.$validator.validateAll().then(i=>{if(i){var r=function(){$.ajax({url:n,data:t.requestModel,method:"POST",success:function(){t.reset();t.reloadListWithPagingAndSearch()},error:function(n){console.log(n)}})};saveFiles("input[type=file]",r)}})},changeBrocureHandler:function(n,t){var i,r,u;(n.which<=90&&n.which>=48||n.which===8)&&(i=$(n.target),i.val()&&(r="/Document/GetList/",u={search:i.val()},this.autocompleteLoad(i,r,u,function(n){t.linkToBrochure=n})))},reloadListWithPagingAndSearch:function(n){var t=!1;n?(n.search=this.searchRequest?this.searchRequest:"",t=!!this.searchRequest):n={search:this.searchRequest?this.searchRequest:""};this.loadRequests(n,t)},changeSearchHandler:function(){this.reloadListWithPagingAndSearch()},changeCurrencyHandler:function(n,t){var i,r,u;(n.which<=90&&n.which>=48||n.which===8)&&(i=$(n.target),i.val()&&(r="/Request/GetCurrencies/",u={search:i.val()},this.autocompleteLoad(i,r,u,function(n){t.currency=n})))},changeManufacturerHandler:function(n,t){var r,i,u,f;(n.which<=90&&n.which>=48||n.which===8)&&(r=$(n.target),i=r.val(),i&&i.length>1&&(u="/Request/GetManufacturers/",f={search:i},this.autocompleteLoad(r,u,f,function(n){t.manufacturer=n})))},changeModelHandler:function(n,t){var i,r,u;(n.which<=90&&n.which>=48||n.which===8||n.which<=111&&n.which>=106)&&(i=$(n.target),i.val()&&(r="/Request/GetManufacturerModels/",u={search:i.val(),searchManufacture:t.manufacturer},this.autocompleteLoad(i,r,u,function(n){t.model=n})))},autocompleteLoad:function(n,t,i,r){$.ajax({url:t,method:"GET",data:i,success:function(t){for(var u={},i=0;i<t.length;i++)u[t[i].name]=null;n.autocomplete({data:u,limit:10,minLength:1,onAutocomplete:r})},error:function(n){console.log(n)}})},uploadFile:function(n,t){uploadFileAndChangeModel(n,t)},setStatus:function(n){this.requestModel.status=n.id;this.requestModel.statusText=n.name},setCorrectDate:function(n){return dateCorrectStr(n)},setNew:function(){this.$validator.reset();this.requestModel={};this.scope="Add new";this.requestDetails=[this.getEmptyDetail()];this.isNew=!0;this.currentRequestStatus=0;this.resetInvoiceFiles()},reset:function(){this.requestModel={};this.$validator.reset();$(".modal").modal("close")},addDetail:function(){this.requestDetails.push(this.getEmptyDetail());setTimeout(function(){r()},300)},getEmptyDetail:function(){return $.extend({},this.emptyDetail)},isShowStatuses:function(){return this.isManager||this.requestModel.status&&this.requestModel.status!==10},setCorrectErrorName:function(n,t,i){return n?n.replace(t,i):n},resetInvoiceFiles:function(){for(var n=0;n<this.requestDetails.length;n++)this.requestDetails[n].invoiceFile||($("#InvoiceFile-text"+n).removeClass("input-validation-error"),$("#InvoiceFile-text-error"+n).addClass("hide"))}}});function r(){function n(n,t,r){n.indexOf("datestudy")>-1&&(i.requestModel.dateStudy=t);n.indexOf("shippingdate")>-1&&(i.requestDetails[r].shippingDate=t);n.indexOf("trainingdate")>-1&&(i.requestDetails[r].trainingDate=t);n.indexOf("installationdate")>-1&&(i.requestDetails[r].installationDate=t);n.indexOf("estimatedleadtime")>-1&&(i.requestDetails[r].estimatedLeadTime=t);n.indexOf("serviceduedate")>-1&&(i.requestDetails[r].serviceDueDate=t);n.indexOf("deinstallduedate")>-1&&(i.requestDetails[r].deInstallDueDate=t);n.indexOf("sivrequireddate")>-1&&(i.requestDetails[r].sivRequiredDate=t);n.indexOf("confirmeddeliverydate")>-1&&(i.requestDetails[r].confirmedDeliveryDate=t);n.indexOf("actualdespatchdate")>-1&&(i.requestDetails[r].actualDespatchDate=t);n.indexOf("actualinstallationdate")>-1&&(i.requestDetails[r].actualInstallationDate=t);n.indexOf("estimatedeliverydate")>-1&&(i.requestDetails[r].estimateDeliveryDate=t);n.indexOf("issueddate")>-1&&(i.requestDetails[r].issuedDate=t);n.indexOf("paymentduedate")>-1&&(i.requestDetails[r].paymentDueDate=t);n.indexOf("paymentrundate")>-1&&(i.requestDetails[r].paymentRunDate=t);n.indexOf("paymentreceiveddate")>-1&&(i.requestDetails[r].paymentReceivedDate=t);i.$validator.reset()}$(".datepicker").pickadate({container:"body",selectMonths:!0,selectYears:15,today:"Today",clear:"Clear",close:"Ok",format:"yyyy-mm-dd",closeOnSelect:!0,onSet:function(){var t=this.$node[0].id.toLowerCase(),i=t.slice(-1);n(t,this.get(),i)},onOpen:function(){this.get()||this.clear()}})}$(document).ready(function(){function u(n){for(var i,u=window.location.href,r=u.split("#"),t=0;t<r.length;t++)if(i=r[t].split("="),i[0]===n)return i[1]}var t=u("request"),n;t&&(n=$("#editRequestModal"),n&&setTimeout(function(){i.edit(t);i.isNew=!1;n.modal("open");initEventsByClosePopup()},500));r();$("#searchRequest").keyup($.debounce(350,i.changeSearchHandler))})}})(Vue,VeeValidate),function(n,t){if(document.querySelector("#clients")){n.use(t);var u=new n({el:"#clients",data:{manageList:[],user:{firstNmae:"",lastName:"",email:"",password:"",confirmPassword:""},emptyUser:{firstNmae:"",lastName:"",email:"",password:"",confirmPassword:""}},created:function(){this.loadData()},methods:{loadData:function(){var n=this,t=window.location.search,i="/Manage/ClientList"+t;$.ajax({url:i,method:"GET",success:function(t){n.manageList=t},error:function(n){console.log(n)}})},edit:function(n){i.edit(n)},resetData:function(){i&&i.resetData&&i.resetData();r&&r.resetData&&r.resetData()}}}),r=new n({el:"#clientsAddNewModel",data:{scope:"Client",user:{firstNmae:"",lastName:"",email:"",password:"",confirmPassword:""},emptyUser:{firstNmae:"",lastName:"",email:"",password:"",confirmPassword:""}},methods:{save:function(){var n=this;this.$validator.validateAll().then(t=>{t&&$.ajax({url:"/Manage/SaveClient",data:this.user,method:"POST",success:function(){n.reset();u.loadData()},error:function(n){console.log(n)}})})},reset:function(){this.resetData();$(".modal").modal("close")},resetData:function(){this.user=this.emptyUser;this.$validator.reset()},setCorrectErrorName:function(n,t,i){return n?n.replace(t,i):n}}}),i=new n({el:"#clientsEditModal",data:{scope:"Client",user:{firstNmae:"",lastName:"",email:""},emptyUser:{firstNmae:"",lastName:"",email:""}},methods:{save:function(){var n=this;this.$validator.validateAll().then(t=>{t&&$.ajax({url:"/Manage/SaveClient",data:this.user,method:"POST",success:function(){n.reset();u.loadData()},error:function(n){console.log(n)}})})},edit:function(n){if(this.resetData(),n){var t=this;$.ajax({url:"/Manage/GetClient",data:{id:n},method:"GET",success:function(n){t.user=n},error:function(n){console.log(n)}})}},reset:function(){this.resetData();$(".modal").modal("close")},resetData:function(){this.user=this.emptyUser;this.$validator.reset()},setCorrectErrorName:function(n,t,i){return n?n.replace(t,i):n}}})}else if(document.querySelector("#managers")){n.use(t);var f=new n({el:"#managers",data:{manageList:[],user:{firstNmae:"",lastName:"",email:"",password:"",confirmPassword:""},emptyUser:{firstNmae:"",lastName:"",email:"",password:"",confirmPassword:""}},created:function(){this.loadData()},methods:{loadData:function(){var n=this,t=window.location.search,i="/Manage/ManagerList"+t;$.ajax({url:i,method:"GET",success:function(t){n.manageList=t},error:function(n){console.log(n)}})},edit:function(n){e.edit(n)},resetData:function(){e.resetData();o.resetData()}}}),o=new n({el:"#managersAddNewModel",data:{scope:"Manager",user:{firstNmae:"",lastName:"",email:"",password:"",confirmPassword:""},emptyUser:{firstNmae:"",lastName:"",email:"",password:"",confirmPassword:""}},methods:{save:function(){var n=this;this.$validator.validateAll().then(t=>{t&&$.ajax({url:"/Manage/SaveManager",data:this.user,method:"POST",success:function(){n.reset();f.loadData()},error:function(n){console.log(n)}})})},reset:function(){this.resetData();$(".modal").modal("close")},resetData:function(){this.user=this.emptyUser;this.$validator.reset()},setCorrectErrorName:function(n,t,i){return n?n.replace(t,i):n}}}),e=new n({el:"#managersEditModal",data:{scope:"Manager",user:{firstNmae:"",lastName:"",email:""},emptyUser:{firstNmae:"",lastName:"",email:""}},methods:{save:function(){var n=this;this.$validator.validateAll().then(t=>{t&&$.ajax({url:"/Manage/SaveManager",data:this.user,method:"POST",success:function(){n.reset();f.loadData()},error:function(n){console.log(n)}})})},edit:function(n){if(this.resetData(),n){var t=this;$.ajax({url:"/Manage/GetManager",data:{id:n},method:"GET",success:function(n){t.user=n},error:function(n){console.log(n)}})}},reset:function(){this.resetData();$(".modal").modal("close")},resetData:function(){this.user=this.emptyUser;this.$validator.reset()},setCorrectErrorName:function(n,t,i){return n?n.replace(t,i):n}}})}}(Vue,VeeValidate),function(n,t){if(document.querySelector("#alerts")){n.use(t);var i=new n({el:"#alerts",data:{textariaClass:"materialize-textarea",colClass:"col",alerts:[],notifyTimes:[]},created:function(){this.loadAlerts()},methods:{loadAlerts:function(){var n=this;$.ajax({url:"/Manage/AlertList",method:"GET",success:function(t){n.notifyTimes=t.notifyTimes;n.alerts=t.alerts;setTimeout(initSelect,100)},error:function(n){console.log(n)}})},save:function(n,t){this.$validator.validateAll().then(i=>{i&&(n.notifyDays=$("#TimeAlert"+t).val(),$.ajax({url:"/Manage/SaveAlert",data:n,method:"POST",error:function(n){console.log(n)}}))})},cancel:function(){this.$validator.reset();this.loadAlerts()},setCorrectErrorName:function(n,t,i){return n?n.replace(t,i):n}}})}}(Vue,VeeValidate),function(n,t){if(n.config.devtools=!0,document.querySelector("#documentVault")){n.use(t);var i=new n({el:"#documentVault",data:{pagingInfo:{contentUrl:"",currentPage:0,endIndex:0,endPage:0,itemsPerPage:0,pages:[],startIndex:0,startPage:0,totalItems:0,totalPages:0},documents:[],searchRequest:""},created:function(){this.loadDocuments()},methods:{loadDocuments:function(n,t){var i=this;t&&showLoader();$.ajax({url:"/Document/List",method:"GET",data:n,success:function(n){i.documents=n.documents;i.pagingInfo=n.pagingInfo;t&&hideLoader()},error:function(n){console.log(n);t&&hideLoader()}})},reloadListWithPagingAndSearch:function(n){var t=!1;n?(n.search=this.searchRequest?this.searchRequest:"",t=!!this.searchRequest):n={search:this.searchRequest?this.searchRequest:""};this.loadDocuments(n,t)},changeSearchHandler:function(){this.reloadListWithPagingAndSearch()}}});$(document).ready(function(){$("#searchRequest").keyup($.debounce(350,i.changeSearchHandler))})}}(Vue,VeeValidate);